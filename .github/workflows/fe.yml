name: Deploy to Somee

on:
  push:
    branches:
      - main    # Deploy mỗi lần push lên nhánh main

jobs:
  build-and-deploy:
    runs-on: windows-latest

    steps:
    # Lấy source từ GitHub
    - name: Checkout repo
      uses: actions/checkout@v3

    # Thiết lập .NET nếu backend là ASP.NET Core 
    - name: Setup .NET
      uses: actions/setup-dotnet@v3
      with:
        dotnet-version: 7.0.x   # đổi theo version của bạn: 6.0, 8.0…

    # Publish project (nếu bạn chỉ có FE static thì xóa bước này)
    - name: Publish project
      run: dotnet publish -c Release -o ./publish

    # Upload lên Somee qua FTP
    - name: FTP Deploy to Somee
      uses: SamKirkland/FTP-Deploy-Action@v4.3.0
      with:
        server: ${{ secrets.SOMEE_FTP_HOST }}     # ftp.somee.com
        username: ${{ secrets.SOMEE_FTP_USER }}   # user FTP
        password: ${{ secrets.SOMEE_FTP_PASS }}   # password FTP
        protocol: ftps
        local-dir: ./publish                      # thư mục cần upload
        server-dir: /wwwroot/                     # thư mục web của Somee
